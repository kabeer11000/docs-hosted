<div id="BLOG_META_DATA" tags="Draft | Yebr | Beta" heading="Creating the Yebr Music Platform" excerpt="Yebr, is a free music streaming and search service which aims to promote free and open-source software services" cover-image="https://cdn.glitch.global/77b4c993-589e-4e39-8500-f03fc9765209/d06c87b2-9f55-47cf-baa5-fc03b642948b.image.png?v=1665946875169" style="visibility:hidden"></div>

Yebr, is a free music streaming and search service which aims to promote free and open-source software services, most of the music streaming industry was behind closed-sourced proprietary software, in an attempt to change that my team and I built Yebr.

(The current description omits details about many services that make Yebr happen, such as the Ai-based search engine and the Yebr design engine more details at research.kabeers.network)

We planned the software architecture to consist of tens of independent microservices which would be scalable and tested separately. One of these services is the sourcing engine, which as the name implies sources music and other audio content from around the web, we started from YouTube, indexing content, and making temporary, cached copies of the content, we planned to progressively add other sources as our platform grew, Yebr however, saw little success. our user base was under 50 people at the time of our first stable release, but these numbers grew rapidly, reaching almost 6 folds, after version 3 which introduced music aggregation, I led this feature, studying and picking algorithms that would recognize and process audio from anywhere on the web, I developed multiple algorithms of our own but for reliability sake, I stuck with Chroma-print, an audio recognition algorithm which is used in Music Brainz AcoustId project.

The idea was to slowly build a music index database by extracting music files, artist data, and other features, and effectively combining them into a knowledge graph which will help our users not only stream the audio directly but also find it on other platforms, and help us create the next big thing in the project, the recommendation engine
towards the start Yebr was equipped with a basic TF-IDF matrix-based recommendation engine that used search and watch data such as titles, and descriptions to recommend music on the platform, as fast and efficient as it was, we soon realized that the algorithm was much more accurate, and its recommendations were generally ignored or disliked by the user, so I went on to create a new AI-based model, I first looked into simpler models such as those which used matrix factorization however at the rate the rating data and number of users and audios on the platform rose every day, and recalculating a matrix model would become infeasible, so I looked towards a deep learning based approach, I was heavily inspired by YouTube's 2010 paper about their algorithm, and DailyMotion's medium blog where they described their deep-learning approach to the problem.

The solution I came up with was a mix of these two approaches, I created a multi-network system that made use of the matrix factorization model for new users, and a deep learning model written in TensorFlow which incorporated over 70 different features such as age, region, and language to predict user taste, the network used a dozen hidden layers, and a weighted sampled softmax function to rank items, a re-ranking network was added in a later update to further increase the accuracy of the predictions,


Other parts of the Yebr service were just as interesting,  we chose to host these micro-services in docker containers, inside a Kubernetes cluster, I wrote the load balancers and domain mapping servers, which helped maintain request load on the servers, and caching servers which prevented extra load from basically DOS'ing the origin servers such as YouTube or Spotify. the domain mapping servers were our fancy approach to SSO and universal login which worked with our custom OAuth implementation, called Kabeer IDP.
The system worked like a charm allowing SSO authentication, and load balancing, simplifying flow for the creation of other features, such as the Yebr Cast, which uses WebSockets and WebRTC to allow device rooms where peers can in a secure way, send messages and events to the host device such as Yebr running on tv.

Making Yebr was very fun and a great learning experience for all of us, I was responsible for not only writing and testing code but also managing cloud infrastructure and Ai and user experience research, managing teams, and coordinating updates, check it out at music.kabeers.network
